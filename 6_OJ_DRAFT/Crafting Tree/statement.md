# Problem. Crafting Tree

$\begin{array}{l l}Time \; limit \; per \; test & :  1 seconds\\ Memory \; limit \; per \; test &:  512 megabytes\\Input& : standard\;  input \\Output & :standard\;  output \\ \end{array}$

作为一个工厂的总工程师，你需要设计一个新的生产线。这个生产线生产一种产品，这种产品需要由一系列的工序来完成。每道工序为某些个中间产物和原材料合成另一个中间产物，最终合成为产品。

产品卖出后，你可以获得 $Q$ 的收益。

这个合成过程可以用一棵树来描述，树的每个节点代表某道工序的产物，而该节点的子节点为参与合成该物品的材料。根节点为最终产品，叶子节点为原料。

我们把这棵树称作**工序树**。

每个原料会有次品概率，如果某个次品原料参与了合成，那么合成产物必然是次品。

每个工序也会有次品概率，即使所有的原料都是优质的，合成产物也有可能是次品。

形式化地，对于一个节点 $u$，设 $p_u$ 为该工序的次品概率，$|v|$ 为该节点的子节点的个数，$p_{u_i}$ 为第 $i$ 个子节点的次品概率那么该节点的最终次品概率为：

$$
P(u) = 1 - \prod_{i=1}^{|v|} (1 - p_{u_i}) \times (1-p_u)
$$

当然，作为总工程师，你不会坐以待毙。

对于购买的原材料，你可以花费一定的成本检查其是否为次品，如果是次品，厂家会无条件退换。

检查 $x$ 件原材料 $u$ 的成本为 $x \times c_u$ 。

每道工序你都可以选择检查成品是否为次品，但是这会有一定的成本。

同理，检查 $x$ 件产物 $u$ 的成本为 $x \times c_u$ 。

如果检查到了次品，你还可以选择将该产物拆除，这样可以得到所有的原料，但是这也会有一定的成本。并且如果原先的原料中有次品，拆除后次品状态不会改变。

拆除 $x$ 件产物 $u$ 的成本为 $x \times d_u$ 。

最坏情况下，如果次品不慎流入市场，消费者会有 $p_f$ 的概率退货，退回的货物可以在消耗 $H_f$ 的固定成本后可以再次销售或拆除。拆除过程依旧符合以上的描述。

你需要设计一个方案，使得最终产品获利期望最大。为了检查你的决策流程是否正确，你需要输出最终销售每件产品的期望利润。

## Input

输入数据中所有的概率均用整数百分比表示，即对于输入的整数 $p$ ，其准确概率为 $p\%$。

第一行一个整数 $n$ 表示工序树上节点的个数，$1\le n \le 20$。

接下来 $n$ 行，每行描述工序树的一条边。

第 $i$ 包含两个整数 $u_i$ 和 $v_i$，表示 $u_i$ 是 $v_i$ 的子节点，$1\le u_i,v_i \le 20$。

接下来 $n$ 行，每行描述工序树的一个节点。

第 $i$ 行包含三个整数 $c_i,d_i,p_i$，表示**检查成品的成本**，**拆除成品的成本**和**合成次品概率**。$1\le c_i,d_i \le 1\times 10^5 , 0\le p_i \le 25$。特别的，如果本节点为叶子节点（即本节点为原料），则 $d_i$为**购入一个此原料的价格**、$p_i$ 为**原料的次品概率**。

最后一行包含三个整数 $p_f,H_f,Q$，表示次品流入市场后**消费者退货的概率**，**退货的固定成本**。$0\le p_f \le 25, 0\le H_f,Q \le 1\times 10^5$。

## Output

输出一行一个浮点数，表示最终销售每件产品的期望利润，保留两位小数。

$^+$本题的SPJ对精度要求不高。将你的答案记为$r_p$，标准答案记为$r_p$，如果你的答案与标准答案的相对误差不超过$10^{-3}$，即$\frac{|r_p-r_s|}{r_s} \le 10^{-3}$，则答案会被认为正确。

### Input Example 1

```text

```

### Output Example 1

```text

```
